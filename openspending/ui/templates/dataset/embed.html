<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
  xmlns:py="http://genshi.edgewall.org/"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  >

  <xi:include href="../_util.html" />
  <!-- templates/dataset/embed.html top -->

  <head>
    <meta charset="utf-8" />
    <title>Embedded Visualisation - ${g.site_title}</title>
    <link rel="shortcut icon" href="${h.static('img/favicon.ico')}" type="image/x-icon" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="${h.static('style/bootstrap.css')}" rel="stylesheet" />
    <link href="${h.static('style/style.css')}" rel="stylesheet" />
    <!-- link href="${h.static('style/embed.css')}" rel="stylesheet" / -->
    <style>
        body, html, #widget {
            padding: 0px;
            margin: 0px;
            width: 100%;
            height: 100%;
        }

        #widget {
            width: 100%;
            height: 100%;
        }
    </style>

    <!-- TODO: Load this from the widget itself. -->
    <link rel="stylesheet" href="${c.widget.base}/css/${c.widget.name}.css" type="text/css" />
    
    <py:if test="defined('optional_head')">
      ${optional_head()}
    </py:if>
  </head>

  <!-- templates/dataset/embed.html body -->

  <body>
    <div id="widget"></div>

    ${script_tag('lib/vendor/jquery')}
    ${script_tag('lib/vendor/underscore')}
    ${script_tag('lib/vendor/handlebars')}
    ${script_tag('lib/vendor/bootstrap')}
    ${script_tag('lib/utils/utils')}

    <script type="text/javascript" src="${c.widget.js}"></script>
    <script>
        var state = ${h.json.dumps(c.state, indent=2)};
        var context = {
            dataset: "${c.dataset.name}",
            siteUrl: "${h.site_url()}",
            time: 2011
            };

        (function ($) {
            new ${c.widget.class_name}($('#widget'), context, state);
        })(jQuery);
    </script>

    ${analytics()}
  </body>
</html>



