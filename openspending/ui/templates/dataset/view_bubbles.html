<html xmlns:py="http://genshi.edgewall.org/"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  py:strip="">

  <py:def function="nav_class">nav-dataset</py:def>

  <py:def function="page_title">${c.dataset['label']}</py:def>

  <form py:def="search_form" method="get" action="search">
      <input type="hidden" name="dataset" value="${c.dataset['label']}"/>
      <input type="search" placeholder="Search ${c.dataset['label']}" name="q"/>
  </form>

  <py:def function="optional_head">
<script src="/bubbletree/jquery.history.js" type="text/javascript"></script>
<script src="/bubbletree/raphael-min.js" type="text/javascript"></script>
<script src="/bubbletree/Tween.js" type="text/javascript"></script>
<script src="/bubbletree/vis4.js" type="text/javascript"></script>
<script src="/bubbletree/bubbletree.js" type="text/javascript"></script>
<script type="text/javascript" src="/bubbletree/jquery.tooltip.min.js"></script>
<script type="text/javascript" src="/bubbletree/aggregator.js"></script>
<link rel="stylesheet" type="text/css" media="all" href="/bubbletree/ugandabubbletree.css" /> 
<script src="/bubbletree/util.js" type="text/javascript"></script>
<script type="text/javascript">
       
		$(function() {		
//			var endpoint = 'http://localhost:5000/api';
			var endpoint = '/api';
			var dataset = '$c.dataset_name';
			var breakdown_styles = {
					<py:for each="k in c.breakdown_styles">
					${k}
					</py:for>
			};

			var drilldowns = $c.drilldown_fields;
			var breakdown = '$c.breakdown_field';

			createBubbles(endpoint, dataset, drilldowns, breakdown, breakdown_styles);
			
		});                                        
	</script>
  </py:def>



	<div class="bubbletree-wrapper">
	  <div class="bubbletree"></div>
	</div>

  <!-- FIXME: genshi code depends on this, but it's invisible from the
	user's perspective -->
  <div py:def="content">
  </div>

  <xi:include href="../layout.html" />
</html>

